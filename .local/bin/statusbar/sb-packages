#!/bin/sh
command -v pacman 1>/dev/null 2>&1 && echo -n "$(pacman -Qu | grep -Fcv "[ignored]" | sed "s/^/ /;s/^ 0$//g")"

if command -v aptitude 1>/dev/null 2>&1; then
    vals=$(aptitude full-upgrade --simulate --assume-yes |
        grep -m1 '^[0-9]\+ packages upgraded,' |
        tr -cd '0-9 ' |
        tr ' ' '\n' |
        grep '[0-9]\+' |
        xargs echo)

    print=" "
    for i in $vals; do
        [ $i != 0 ] && icon="\033[11m\033[10m"
        print="$print$i/"
    done

    [ -n "$icon" ] && printf "$icon " && echo "$print" | sed 's/\/$//'
fi
